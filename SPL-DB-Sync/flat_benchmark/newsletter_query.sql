-- SPL-DB-Sync Experiment: Flat Approach (Realistic Inefficiency)
-- Common anti-pattern: Separate subqueries for each condition check
-- This is how developers often write when they don't understand JOINs well
SELECT 
    C.C_NAME,
    C.C_ACCTBAL,
    (SELECT COUNT(O.O_ORDERKEY) 
     FROM {ORDERS_TABLE} O 
     WHERE O.O_CUSTKEY = C.C_CUSTKEY 
     AND O.O_TOTALPRICE > 100000) as ORDER_COUNT
FROM {CUSTOMER_TABLE} C
WHERE C.C_ACCTBAL > 5000
AND EXISTS (SELECT 1 FROM {ORDERS_TABLE} O1 WHERE O1.O_CUSTKEY = C.C_CUSTKEY AND O1.O_TOTALPRICE > 100000)
AND EXISTS (SELECT 1 FROM {ORDERS_TABLE} O2 WHERE O2.O_CUSTKEY = C.C_CUSTKEY AND O2.O_TOTALPRICE > 100000 AND O2.O_ORDERKEY != (SELECT MIN(O3.O_ORDERKEY) FROM {ORDERS_TABLE} O3 WHERE O3.O_CUSTKEY = C.C_CUSTKEY AND O3.O_TOTALPRICE > 100000))
ORDER BY C.C_ACCTBAL DESC;
