-- SPL-DB-Sync Experiment: Flat Approach (Inefficient)
-- Poorly structured identification using multiple redundant correlated subqueries
SELECT 
    C.C_NAME,
    C.C_ACCTBAL,
    (SELECT COUNT(O2.O_ORDERKEY) 
     FROM {ORDERS_TABLE} O2 
     WHERE O2.O_CUSTKEY = C.C_CUSTKEY 
     AND O2.O_TOTALPRICE > 100000) as ORDER_COUNT
FROM {CUSTOMER_TABLE} C
WHERE C.C_ACCTBAL > 5000
AND (SELECT COUNT(*) 
     FROM {ORDERS_TABLE} O1 
     WHERE O1.O_CUSTKEY = C.C_CUSTKEY 
     AND O1.O_TOTALPRICE > 100000) >= 2
AND (SELECT COUNT(*) 
     FROM {ORDERS_TABLE} O3 
     WHERE O3.O_CUSTKEY = C.C_CUSTKEY) > 0
AND (SELECT AVG(O4.O_TOTALPRICE) 
     FROM {ORDERS_TABLE} O4 
     WHERE O4.O_CUSTKEY = C.C_CUSTKEY) IS NOT NULL
ORDER BY (SELECT MAX(O5.O_TOTALPRICE) 
          FROM {ORDERS_TABLE} O5 
          WHERE O5.O_CUSTKEY = C.C_CUSTKEY) DESC;
